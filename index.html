<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Resource Center Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --muted: #9ca3af;
      --text: #e5e7eb;
      --primary: #3b82f6;
      --primary-700: #2563eb;
      --accent: #22c55e;
      --danger: #ef4444;
      --warning: #f59e0b;
      --border: #1f2937;
      --chip: #374151;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: linear-gradient(180deg, #0b1220 0%, #0f172a 100%);
      color: var(--text);
    }
    .container {
      max-width: 1200px;
      margin: 24px auto;
      padding: 0 16px;
    }
    header {
      background: rgba(17, 24, 39, 0.8);
      backdrop-filter: blur(8px);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 16px;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr auto;
      gap: 12px;
      align-items: center;
    }
    header h1 {
      margin: 0;
      font-size: 18px;
      letter-spacing: 0.3px;
      color: #cbd5e1;
    }
    .control {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .control label {
      font-size: 12px;
      color: var(--muted);
    }
    .control input[type="date"],
    .control select {
      background: #0b1020;
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 8px 10px;
      outline: none;
      width: 100%;
    }
    .tabs {
      margin-top: 16px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .tab {
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #0b1020;
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 600;
      font-size: 13px;
    }
    .tab.active {
      background: var(--primary);
      border-color: var(--primary-700);
      color: white;
      box-shadow: 0 6px 18px rgba(59, 130, 246, 0.25);
    }
    .subtabs {
      margin-top: 10px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .chip {
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--chip);
      color: #cbd5e1;
      border: 1px solid var(--border);
      cursor: pointer;
      font-size: 12px;
    }
    .chip.active {
      background: #1f2937;
      color: #fff;
      border-color: var(--primary);
    }
    .panel {
      margin-top: 16px;
      background: rgba(17, 24, 39, 0.8);
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
    }
    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
      <div class="actions">
  <button class="btn secondary" id="tableViewBtn">Table</button>
  <button class="btn secondary" id="cardViewBtn">Cards</button>
  <button class="btn secondary" id="exportBtn">Export JSON</button>
  <button class="btn secondary" id="clearBtn">Clear current view</button>
</div>

    }
    .panel-header h2 {
      margin: 0;
      font-size: 16px;
      color: #cbd5e1;
    }
    .btn {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid var(--primary-700);
      background: var(--primary);
      color: white;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
      transition: transform 0.05s ease, box-shadow 0.2s ease;
    }
    .btn:hover { box-shadow: 0 6px 18px rgba(59, 130, 246, 0.25); }
    .btn:active { transform: translateY(1px); }
    .btn.secondary {
      background: #0b1020;
      color: #cbd5e1;
      border-color: var(--border);
    }
    .btn.danger {
      background: var(--danger);
      border-color: #b91c1c;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    thead th {
      text-align: left;
      font-size: 12px;
      color: var(--muted);
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      background: #0b1020;
    }
    tbody td {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      font-size: 14px;
      color: #e5e7eb;
    }
    tbody tr:hover {
      background: rgba(30, 41, 59, 0.35);
    }
    .status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
    }
    .status.active { background: rgba(34, 197, 94, 0.15); color: #86efac; border: 1px solid rgba(34, 197, 94, 0.35); }
    .status.inactive { background: rgba(239, 68, 68, 0.15); color: #fecaca; border: 1px solid rgba(239, 68, 68, 0.35); }
    .actions {
        <button class="btn secondary" id="tableViewBtn">Table</button>
        <button class="btn secondary" id="cardViewBtn">Cards</button>
      display: flex;
      gap: 8px;
    }
    /* Modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(2, 6, 23, 0.6);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal {
      width: 95%;
      max-width: 560px;
      background: #0b1020;
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }
    .modal header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
      background: #0b1020;
    }
    .modal header h3 {
      margin: 0;
      font-size: 16px;
      color: #cbd5e1;
    }
    .modal .content {
      padding: 16px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .field label {
      font-size: 12px;
      color: var(--muted);
    }
    .field input, .field select {
      background: #0b1020;
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 10px;
      outline: none;
      width: 100%;
    }
    .modal footer {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      padding: 14px 16px;
      border-top: 1px solid var(--border);
      background: #0b1020;
    }
    /* Responsive */
    @media (max-width: 720px) {
      header { grid-template-columns: 1fr; }
      .modal .content { grid-template-columns: 1fr; }
      .panel-header { flex-direction: column; align-items: flex-start; gap: 10px; }
      .actions { flex-wrap: wrap; }
    }
    .cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 14px;
  padding: 16px;
}

.card {
  background: #0b1020;
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 14px;
}

.card h4 {
  margin: 0 0 6px;
}

.card .muted {
  color: var(--muted);
  font-size: 12px;
}

  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Resource Center Dashboard</h1>
      <div class="control">
        <label for="date">Date</label>
        <input type="date" id="date" />
      </div>
      <div class="control">
        <label for="shift">Shift</label>
        <select id="shift">
          <option value="Morning">Morning</option>
          <option value="Evening">Evening</option>
          <option value="Night">Night</option>
        </select>
      </div>
      <div class="control" style="justify-content:flex-end;">
        <button class="btn" id="addResourceBtn">+ Add resource</button>
        <button class="btn secondary" id="quickAddBtn">⚡ Quick Add</button>
      </div>
    </header>

    <div class="tabs" id="categoryTabs">
      <button class="tab active" data-category="Hospital">Hospital</button>
      <button class="tab" data-category="KK">KK</button>
      <button class="tab" data-category="STJOHN">St. John</button>
    </div>

    <div class="subtabs" id="subTabs">
      <!-- Subcategory chips injected here -->
    </div>

    <div class="panel">
      <div class="panel-header">
        <h2 id="panelTitle">Hospital — HTAR</h2>
        <div class="actions">
          <button class="btn secondary" id="exportBtn">Export JSON</button>
          <button class="btn secondary" id="clearBtn">Clear current view</button>
        </div>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Team</th>
              <th>PPP/PKB</th>
              <th>Ambulance No.</th>
              <th>Status</th>
              <th style="width:160px;">Actions</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <!-- Rows injected here -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="modalBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <header>
        <h3 id="modalTitle">Add resource</h3>
        <button class="btn secondary" id="closeModalBtn">Close</button>
      </header>
      <div class="content">
        <div class="field">
          <label for="resName">Name</label>
          <input id="resName" type="text" placeholder="Full name" />
        </div>
        <div class="field">
          <label for="resTeam">Team</label>
          <input id="resTeam" type="text" placeholder="Team name" />
        </div>
        <div class="field">
          <label for="resPPP">PPP/PKB</label>
          <select id="resPPP">
            <option value="PPP">PPP</option>
            <option value="PKB">PKB</option>
          </select>
        </div>
        <div class="field">
          <label for="resAmb">Ambulance No.</label>
          <input id="resAmb" type="text" placeholder="e.g., AMB-12" />
        </div>
        <div class="field">
          <label for="resStatus">Status</label>
          <select id="resStatus">
            <option value="Active" selected>Active</option>
            <option value="Inactive">Inactive</option>
          </select>
        </div>
        <div class="field">
          <label for="resCategory">Category</label>
          <select id="resCategory">
            <option value="Hospital">Hospital</option>
            <option value="KK">KK</option>
            <option value="STJOHN">STJOHN</option>
          </select>
        </div>
        <div class="field">
          <label for="resSubcat">Subcategory</label>
          <select id="resSubcat">
            <!-- Filled dynamically based on category -->
          </select>
        </div>
      </div>
      <footer>
        <button class="btn secondary" id="resetFormBtn">Reset</button>
        <button class="btn" id="saveResourceBtn">Save</button>
      </footer>
    </div>
  </div>
<script>
// table | card
  const state = {
  category: "Hospital",
  subcat: "HTAR",
  editingId: null,
  view: "table"
};


function quickAdd() {
  const name = prompt("Enter resource name:");
  if (!name) return;

  const ppp = prompt("PPP or PKB?", "PPP");
  if (!ppp) return;

  const data = loadData();

  data.push({
    id: crypto.randomUUID(),
    name: name.trim(),
    team: "—",
    ppp: ppp.toUpperCase(),
    ambulance: "",
    status: "Active",
    category: state.category,
    subcat: state.subcat
  });

  saveData(data);
  renderTable();
}

document.getElementById('quickAddBtn')
  .addEventListener('click', quickAdd);
</script>
  <script>
    // Data model and persistence
    const SUBCATS = {
      Hospital: ["HTAR", "HSAS", "HBT", "HASA"],
      KK: ["KLANG", "K.LANGAT"],
      STJOHN: ["STJOHN"]
    };

    const state = {
      category: "Hospital",
      subcat: "HTAR",
      editingId: null
    };

    function storageKey() {
      const date = document.getElementById('date').value || 'any';
      const shift = document.getElementById('shift').value || 'any';
      return `resources:${date}:${shift}`;
    }

    function loadData() {
      const raw = localStorage.getItem(storageKey());
      return raw ? JSON.parse(raw) : [];
    }

    function saveData(data) {
      localStorage.setItem(storageKey(), JSON.stringify(data));
    }

    // UI helpers
    function setPanelTitle() {
      document.getElementById('panelTitle').textContent = `${state.category} — ${state.subcat}`;
    }

    function renderSubtabs() {
      const wrap = document.getElementById('subTabs');
      wrap.innerHTML = '';
      SUBCATS[state.category].forEach(sub => {
        const chip = document.createElement('button');
        chip.className = 'chip' + (sub === state.subcat ? ' active' : '');
        chip.textContent = sub;
        chip.dataset.subcat = sub;
        chip.addEventListener('click', () => {
          state.subcat = sub;
          renderSubtabs();
          setPanelTitle();
          renderTable();
        });
        wrap.appendChild(chip);
      });
    }

 function renderTable() {
  const wrap = document.querySelector('.table-wrap');
  wrap.innerHTML = '';

  const data = loadData()
    .filter(r => r.category === state.category && r.subcat === state.subcat);

  if (state.view === "card") {
    const cards = document.createElement('div');
    cards.className = 'cards';

    data.forEach(r => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h4>${r.name}</h4>
        <div class="muted">${r.team}</div>
        <div>${r.ppp} • ${r.ambulance || 'No Ambulance'}</div>
        <div class="status ${r.status === 'Active' ? 'active' : 'inactive'}">
          ${r.status}
        </div>
      `;
      cards.appendChild(card);
    });

    wrap.appendChild(cards);
    return;
  }

  wrap.innerHTML = `
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Team</th>
          <th>PPP/PKB</th>
          <th>Ambulance</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  `;

  const tbody = document.getElementById('tableBody');

  data.forEach(r => {
    const tr = document.createElement('tr');

    tr.innerHTML = `
      <td>${r.name}</td>
      <td>${r.team}</td>
      <td>${r.ppp}</td>
      <td>${r.ambulance}</td>
      <td>
        <span class="status ${r.status === 'Active' ? 'active' : 'inactive'}">
          ${r.status}
        </span>
      </td>
      <td>
        <button class="btn secondary">Edit</button>
        <button class="btn danger">Delete</button>
      </td>
      ';
    tr.querySelector('.btn.secondary').onclick = () => openModal(r.id);
    tr.querySelector('.btn.danger').onclick = () => deleteResource(r.id);
    tbody.appendChild(tr);
  });
}


  // ===== TABLE VIEW (existing logic) =====
  wrap.innerHTML = `
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Team</th>
          <th>PPP</th>
           <th>PKB</th>
          <th>Ambulance</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  `;
  // reuse your existing row render
  document.getElementById('tableBody').innerHTML = '';
  data.forEach(r => { /* existing row code */ });
}

      data.forEach(r => {
        const tr = document.createElement('tr');

        const tdName = document.createElement('td'); tdName.textContent = r.name;
        const tdTeam = document.createElement('td'); tdTeam.textContent = r.team;
        const tdPPP = document.createElement('td'); tdPPP.textContent = r.ppp;
        const tdAmb = document.createElement('td'); tdAmb.textContent = r.ambulance;
        const tdStatus = document.createElement('td');
        const status = document.createElement('span');
        status.className = 'status ' + (r.status === 'Active' ? 'active' : 'inactive');
        status.textContent = r.status;
        tdStatus.appendChild(status);

        const tdActions = document.createElement('td');
        const editBtn = document.createElement('button');
        editBtn.className = 'btn secondary';
        editBtn.textContent = 'Edit';
        editBtn.addEventListener('click', () => openModal(r.id));
        const delBtn = document.createElement('button');
        delBtn.className = 'btn danger';
        delBtn.textContent = 'Delete';
        delBtn.addEventListener('click', () => deleteResource(r.id));
        tdActions.appendChild(editBtn);
        tdActions.appendChild(delBtn);

        tr.appendChild(tdName);
        tr.appendChild(tdTeam);
        tr.appendChild(tdPPP);   
        tr.appendChild(tdPKB);
        tr.appendChild(tdAmb);
        tr.appendChild(tdStatus);
        tr.appendChild(tdActions);

        tbody.appendChild(tr);
      });
    }

    // Modal logic
    const backdrop = document.getElementById('modalBackdrop');
    const resName = document.getElementById('resName');
    const resTeam = document.getElementById('resTeam');
    const resPPP = document.getElementById('resPPP'); 
    const resPKB = document.getElementById('resPKB');
    const resAmb = document.getElementById('resAmb');
    const resStatus = document.getElementById('resStatus');
    const resCategory = document.getElementById('resCategory');
    const resSubcat = document.getElementById('resSubcat');

    function fillSubcatSelect(cat) {
      resSubcat.innerHTML = '';
      SUBCATS[cat].forEach(s => {
        const opt = document.createElement('option');
        opt.value = s; opt.textContent = s;
        resSubcat.appendChild(opt);
      });
    }

    function openModal(editId = null) {
      state.editingId = editId;
      document.getElementById('modalTitle').textContent = editId ? 'Edit resource' : 'Add resource';
      // Default form values
      resName.value = '';
      resTeam.value = '';
      resPPP.value = 'PPP';
      resPkb.value = 'Pkb';
      resAmb.value = '';
      resStatus.value = 'Active';
      resCategory.value = state.category;
      fillSubcatSelect(state.category);
      resSubcat.value = state.subcat;

      if (editId) {
        const data = loadData();
        const item = data.find(r => r.id === editId);
        if (item) {
          resName.value = item.name;
          resTeam.value = item.team;
          resPPP.value = item.ppp; 
          resPKB.value = item.pkb;
          resAmb.value = item.ambulance;
          resStatus.value = item.status;
          resCategory.value = item.category;
          fillSubcatSelect(item.category);
          resSubcat.value = item.subcat;
        }
      }
      backdrop.style.display = 'flex';
      backdrop.setAttribute('aria-hidden', 'false');
    }

    function closeModal() {
      backdrop.style.display = 'none';
      backdrop.setAttribute('aria-hidden', 'true');
      state.editingId = null;
    }

    function resetForm() {
      resName.value = '';
      resTeam.value = '';
      resPPP.value = 'PPP'; resPKB.value = 'PKB';
      resAmb.value = '';
      resStatus.value = 'Active';
      resCategory.value = state.category;
      fillSubcatSelect(state.category);
      resSubcat.value = state.subcat;
    }

    function saveResource() {
      const payload = {
        id: state.editingId || crypto.randomUUID(),
        name: resName.value.trim(),
        team: resTeam.value.trim(),
        ppp: resPPP.value,pkb: resPKB.value,
        ambulance: resAmb.value.trim(),
        status: resStatus.value,
        category: resCategory.value,
        subcat: resSubcat.value
      };
      if (!payload.name) { alert('Name is required'); return; }
      if (!payload.team) { alert('Team is required'); return; }

      const data = loadData();
      const idx = data.findIndex(r => r.id === payload.id);
      if (idx >= 0) {
        data[idx] = payload;
      } else {
        data.push(payload);
      }
      saveData(data);
      closeModal();
      // If saved to current view, refresh; otherwise, keep current view
      renderTable();
    }

    function deleteResource(id) {
      if (!confirm('Delete this resource?')) return;
      const data = loadData().filter(r => r.id !== id);
      saveData(data);
      renderTable();
    }

    // Event bindings
    document.getElementById('addResourceBtn').addEventListener('click', () => openModal());
    document.getElementById('closeModalBtn').addEventListener('click', closeModal);
    document.getElementById('resetFormBtn').addEventListener('click', resetForm);
    document.getElementById('saveResourceBtn').addEventListener('click', saveResource);
    backdrop.addEventListener('click', (e) => {
      if (e.target === backdrop) closeModal();
    });

    document.getElementById('date').addEventListener('change', () => {
      renderTable();
    });
    document.getElementById('shift').addEventListener('change', () => {
      renderTable();
    });

    document.getElementById('resCategory').addEventListener('change', (e) => {
      fillSubcatSelect(e.target.value);
      resSubcat.value = SUBCATS[e.target.value][0];
    });

    document.getElementById('exportBtn').addEventListener('click', () => {
      const data = loadData().filter(r => r.category === state.category && r.subcat === state.subcat);
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `resources-${state.category}-${state.subcat}.json`;
      a.click();
      URL.revokeObjectURL(url);
    });

    document.getElementById('clearBtn').addEventListener('click', () => {
      if (!confirm(`Clear all resources for ${state.category} — ${state.subcat} (current date/shift only)?`)) return;
      const data = loadData().filter(r => !(r.category === state.category && r.subcat === state.subcat));
      saveData(data);
      renderTable();
    });

    document.querySelectorAll('#categoryTabs .tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('#categoryTabs .tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        state.category = tab.dataset.category;
        state.subcat = SUBCATS[state.category][0];
        renderSubtabs();
        setPanelTitle();
        renderTable();
      });
    });

    // Initialize
    (function init() {
      // Default date to today
      const dateInput = document.getElementById('date');
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const dd = String(today.getDate()).padStart(2, '0');
      dateInput.value = `${yyyy}-${mm}-${dd}`;

      renderSubtabs();
      setPanelTitle();
      renderTable();
    })();
    document.getElementById('tableViewBtn').onclick = () => {
  state.view = "table";
  renderTable();
};

document.getElementById('cardViewBtn').onclick = () => {
  state.view = "card";
  renderTable();
};
  </script>
</body>
</html>
